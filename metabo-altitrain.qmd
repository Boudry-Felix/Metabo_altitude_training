---
title: "Metabolomics in altitude for trained and untrained subjects"
author: FÃ©lix Boudry
---

# Context

High level rowers participated in an altitude training camp at 1800m during which urine sammples were retrieved. Here we analyze those samples after they were analysed by NMR.

```{r}
#| label: config
#| warning: false
#| include: false
library(tidyverse)
library(data.table)
library(janitor)
source(file = "functions.R |> ")

theme_set(new = theme_bw()) # ggplot theme
```

# Import and pre-processing

Pre-processing was done using [npflow](https://nmrprocflow.org). This pre-processing is based on the [Rnmr1D](https://cran.r-project.org/web/packages/Rnmr1D/index.html) package.

```{r}
#| label: import & pre-processing
antrop_data <- fread(input = "Data/subjects.csv") |>
  clean_names() |>
  select(c("age", "height", "weight"))
categories <- c("patho", "day", "Samplecode", "name", "surname", "discriminant", "date", "quality", "pathology_during")
bucket_matrix <- fread("Data/data.csv") |>
  mutate(across(-any_of(categories), ~ ReplaceMissingByLoD(int.mat = .x))) |>
  mutate(across(-any_of(categories), ~ scale(.x))) |>
  merge(fread("Data/samples.csv"), by = "Samplecode") |>
  replace_na(list(patho = 0, pathology_during = 0)) |>
  column_to_rownames(var = "Samplecode") |>
  mutate(patho = as.factor(patho))
```